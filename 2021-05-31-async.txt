                     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                                MAY 2021
                      Asynchronous code execution

                                  TEC
                     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”


                               2021-05-31


Async Babel sessions have landed
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Jack Kamm has made a fantastic contribution to Org: `ob-comint.el' now
  supports asynchronous output from source blocks /with full support for
  sessions/ ğŸ‰.

  If you haven't used sessions before, you're in for a treat! By simply
  assigning a named session to a source code block, e.g. `:session foo',
  the same process will be reused for any other code blocks that specify
  the `foo' session. To do this for a certain language across the entire
  document, you can set the header argument property, i.e.
  â”Œâ”€â”€â”€â”€
  â”‚ #+property: header-args:lang :session foo
  â””â”€â”€â”€â”€

  Along with the asynchronous process communication in `ob-comint.el',
  we have an implementation for *Python*, and we should see support for
  *R* and *Ruby* in the not-too-distant future ğŸ˜.

  To use this, just add the `:async' parameter to a python
  block. Instead of Emacs freezing until it completes execution, you'll
  see a placeholder inserted which is replaced by the result when it is
  ready.

  [emacs-jupyter] allowed for asynchronous code execution (with
  sessions), but it's great to have a solution that doesn't require
  Jupyter kernels, and is part of Org.


[emacs-jupyter] <https://github.com/nnicandro/emacs-jupyter>


Font lock for inline export snippets
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Now, this isn't necessarily a significant change, but I don't think
  many people know about this feature so I'll take the opportunity to go
  over it ğŸ™‚.

  If you want to include a snippet of HTML/LaTeX etc. when exporting to
  that format, you can use a `#+begin_export html' block which simply
  includes the enclosed content verbatim. This doesn't really work for
  small inline snippets though â€” but never fear, Org has /inline/ export
  snippets which simply follow the form `@@format:content@@'. For
  example:

  â”Œâ”€â”€â”€â”€
  â”‚ I love using Org to export to @@html:<abbr title="Hyper Text Markup Language">HTML</abbr>@@ @@latex:\LaTeX{}@@ documents.
  â””â”€â”€â”€â”€
  which will export to HTML as,
  â”Œâ”€â”€â”€â”€
  â”‚ I love using Org to export to <abbr title="Hyper Text Markup Language">HTML</abbr> documents.
  â””â”€â”€â”€â”€
  and then in LaTeX will be,
  â”Œâ”€â”€â”€â”€
  â”‚ I love using Org to export to \LaTeX{} documents.
  â””â”€â”€â”€â”€
  isn't that neat!

  Now you'll find the `@@' parts using the comment face and the
  `format:' bit using the Org tag's face. It's a small change, but it
  makes it easier to see what's going on.

  No mode-specific syntax highlighting yet, but that may come in the
  future ğŸ˜‰.


`#+plot' your `#+results'
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Org-plot has been getting some more love as of late (see [last month's
  post]), and that hasn't stopped yet. This month there's been a fairly
  minor change that I'm quite a fan of. If you have a source block that
  produces a table of `#+results', you can now put a `#+plot' statement
  immediately above to get a visualisation of those results!

  â”Œâ”€â”€â”€â”€
  â”‚ #+begin_src python
  â”‚ # pretend this is some profound source of information
  â”‚ return [[i, i^3 - 4*i^2 - 2*i] for i in range(5)]
  â”‚ #+end_src
  â”‚ 
  â”‚ #+plot: ind:1
  â”‚ #+RESULTS:
  â”‚ | 0 |  1 |
  â”‚ | 1 | -2 |
  â”‚ | 2 |  7 |
  â”‚ | 3 |  8 |
  â”‚ | 4 | 13 |
  â””â”€â”€â”€â”€

  As usual, this relies on `gnuplot' being present. You can read more
  about it in the [manual].


[last month's post] <file:2021-04-30-export-plot.org>

[manual] <https://orgmode.org/manual/Org-Plot.html>


Fancier LaTeX verses
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  With the use of `verse.sty' you can now export fancier verses from
  Org, as verse blocks now support four new attributes:
  âƒ `:lines' for the numbering interval.
  âƒ `:center' which can be set to `t' and works as long as,
    â€¢ `:versewidth', the longest line in the verse as a text string is
      set.
  âƒ You can also easily add arbitrary LaTeX code to be included with
    `:latexcode'.

  â”Œâ”€â”€â”€â”€
  â”‚ #+latex_header: \usepackage{verse}
  â”‚ 
  â”‚ #+latex: \poemtitle{A Dream Within a Dream}
  â”‚ #+attr_latex: :lines 3 :center t
  â”‚ #+attr_latex: :versewidth Through my fingers to the deep,
  â”‚ #+begin_verse
  â”‚ Take this kiss upon the brow!
  â”‚ And, in parting from you now,
  â”‚ Thus much let me avow â€”
  â”‚ You are not wrong, who deem
  â”‚ That my days have been a dream;
  â”‚ Yet if hope has flown away
  â”‚ In a night, or in a day,
  â”‚ In a vision, or in none,
  â”‚ Is it therefore the less /gone?/
  â”‚ /All/ that we see or seem
  â”‚ Is but a dream within a dream.
  â”‚ 
  â”‚ I stand amid the roar
  â”‚ Of a surf-tormented shore,
  â”‚ And I hold within my hand
  â”‚ Grains of the golden sand â€”
  â”‚ How few! yet how they creep
  â”‚ Through my fingers to the deep,
  â”‚ While I weep â€” while I weep!
  â”‚ O God! Can I not grasp
  â”‚ Them with a tighter clasp?
  â”‚ O God! can I not save
  â”‚ /One/ from the pitiless wave?
  â”‚ Is /all/ that we see or seem
  â”‚ But a dream within a dream?
  â”‚ #+end_verse
  â””â”€â”€â”€â”€

  <file:figures/org-verses-example-poem-dream-within-dream.png>


Easy zero-width spaces with Org
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Occasionally you may run into annoyances when you wish to have two
  different Org elements right next to each other (no space) â€” for
  example, *emph*asising part of a word or putting a currency symbol
  immediately before an inline source block.

  The best solution to this in Org is zero-width spaces. As such, I've
  found it rather nice adding insertion of a zero-width space to the
  `org-mode-map' in my config. Perhaps some of you might find this
  solution useful too ğŸ™‚.

  â”Œâ”€â”€â”€â”€
  â”‚ (define-key org-mode-map (kbd "M-SPC M-SPC")
  â”‚   (lambda () (interactive) (insert "\u200b")))
  â””â”€â”€â”€â”€

  Should you want to keep zero-width spaces out of exports, that's easy
  enough to accomplish with an [export filter].

  â”Œâ”€â”€â”€â”€
  â”‚ (defun +org-export-remove-zero-width-space (text _backend _info)
  â”‚   "Remove zero width spaces from TEXT."
  â”‚   (unless (org-export-derived-backend-p 'org)
  â”‚     (replace-regexp-in-string "\u200b" "" text)))
  â”‚ 
  â”‚ (add-to-list 'org-export-filter-final-output-functions #'+org-export-remove-zero-width-space t)
  â””â”€â”€â”€â”€


[export filter]
<https://orgmode.org/manual/Advanced-Export-Configuration.html>


Org's repos have moved
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âƒ `contrib/' is now at <https://git.sr.ht/~bzg/org-contrib> for Org
    9.5, and it will be available on Non-GNU ELPA.
  âƒ Worg is now at <https://git.sr.ht/~bzg/worg>
  âƒ Org itself is moving to Savannah


Other improvements
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âƒ Add support for `HHhMM' date formats (e.g. `13h20') _Gustavo Barros_
  âƒ Make tangling faster /and/ more robust _SÃ©bastien Miquel_
  âƒ Allow importing tables from files that /don't/ end in `.txt',
    `.tsv', or `.csv' _Utkarsh Singh_
  âƒ Add an SVG-specific post-export `ob-plantuml' step:
    `org-babel-plantuml-svg-text-to-path' for running Inkscape
    text-to-path replacement _Nick Daly_
  âƒ Refactor JavaScript in `ox-html' _Anthony Carrico_
  âƒ Set `org-html-head-include-scripts' to `nil' by default (was `t')
    _Bastien Guerry_
  âƒ Remove LaTeX-environment type `#+results' _TEC_
  âƒ New capture templates parameter, `:refile-targets' _Richard Garner_
  âƒ Merge `org-speed-commands-default' and `org-speed-commands-user'
    into a new variable, `org-speed-commands' _Bastien Guerry_
  âƒ URL recognition regex now handles up to two levels of nested
    brackets, and is tested _Ihor Radchenko_
  âƒ Cache parent heading positions for faster movement up
    buffers. Significantly improves Org queries involving inheritance
    (~15-50x improvement) _Ihor Radchenko_
  âƒ New command `org-refile-reverse' bound to `C-c C-M-w' _Adam Spiers_
  âƒ Allow inline tasks to be dragged up/down _Bastien Guerry_
  âƒ LaTeX export, allow arbitrary `:float' values _Thomas S. Dye_
  âƒ Org attach git, new option `org-attach-git-dir' to use the
    attachment dir as a git repository _Juan Manuel MacÃ­as_
  âƒ Use a write-back buffer in Org src _SÃ©bastien Miquel_
  âƒ Add the `:environment' and `:options' LaTeX attributes to Quote
    blocks _Juan Manuel Macias_
  âƒ Surround LaTeX `:options' attribute with curly braces when it
    contains square braces _Markus Huber_
  âƒ Recognise the specific contributions of Kyle Meyer, Ihor Radchenko,
    and TEC in the manual _Bastien Guerry_
  âƒ Improve test coverage _Ihor Radchenko, KÃ©vin Le Gouguec_
  âƒ A bikeshed of new maintainers
    â€¢ New maintainer for `ox-html' â€” TEC
    â€¢ New `ob-ledger' maintainer â€” Eric S Fraga
    â€¢ New `ob-awk' maintainer â€” Tyler Smith
    â€¢ New `ob-calc' maintainer â€” Tom Gillespie
    â€¢ New `ob-asymptote' and `ob-coq' maintainer â€” Luc Pellissier
  âƒ General code cleanup _Bastien Guerry_
  âƒ Documentation improvements _Bastien Guerry, Eric S Fraga, Samim
    Pezeshki, Nicolar Goaziou_


Bugfixes
â•â•â•â•â•â•â•â•

  âƒ Make `ob-gnuplot' work on remote systems _Ihor Radchenko_
  âƒ Stop `M-x org-toggle-link-display' from affecting emphasis markers
    _Bastien Guerry_
  âƒ Inserting a heading before a headline _Bastien Guerry_
  âƒ Perform `org-entry-put' in a read-only buffer _Ihor Radchenko_
  âƒ Emacs 24 compatibility for `ob-C' and `org-agenda-show-new-time'
    _Kyle Meyer_
  âƒ Maintain Org's keybindings when `visual-line-mode' active _Bastien
    Guerry_
  âƒ Keep track of start of region beginning in `org-table-wrap-region'
    _Bastien Guerry_
  âƒ Ensure correct visibility when unfolding subtree _Bastien Guerry_
  âƒ Corner case in `org--backwards-paragaph-once' _Bastien Guerry_
  âƒ Some byte compiler silencing _Kyle Meyer_
  âƒ Make tags filtering case-sensitive _Bastien Guerry_
  âƒ `C-c C-c' on a `#+plot' line can no longer cause an error _Bastien
    Guerry_
  âƒ Ensure consistent position-translation in `org-src' by using point
    for position instead of column _TEC_
  âƒ Prevent `ob-sql' from getting stuck on an error _Ivan Sokolov_
  âƒ Make `org-columns' respect `global-visual-line-mode', and simplify
    tag scanning _Nick Savage_
  âƒ Don't fontify `::' in headlines as description item _Ihor Radchenko_
  âƒ Handle a few corner-cases in `ob-R' _Jeremie Juste_
  âƒ Many fixes to `org-indent-line' _Bastien Guerry_
  âƒ Make headline numbering consistent with TOC _Mingkai Dong_
  âƒ Allow read-only tangling again, and ensure the correct filename is
    used _SÃ©bastien Miquel_
  âƒ Fix edge case when converting durations to minutes _Nicolas Goaziou_
  âƒ Make org-refile work in non-file-visiting buffers _Bastien Guerry_
  âƒ Be more rigorous in `org-sort-remove-invisible' _Nicolas Goaziou_
  âƒ Don't update checkbox stats when heading has `todo' `COOKIE_DATA'
    _Bastien Guerry_
  âƒ Don't recognise a lone `:END:' to be forming a drawer _Nicolas
    Goaziou_
  âƒ Allow new footnotes in empty table cells _Nicolas Goaziou_
